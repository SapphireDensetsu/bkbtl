#summary Порты БК.
#labels Featured

= Порты БК =

== 177130 ==
Регистр управления КНГМД.

По чтению:
 * бит 0: признак 0-ой дорожки
 * бит 1: готовность к работе
 * бит 2: защита от записи
 * бит 7: запрос на чтение/запись данных из регистра данных
 * бит 14: форматирование
 * бит 15: признак 0-го сектора

По записи:
 * биты 0-3: выбор накопителя
 * бит 4: включение мотора
 * бит 5: выбор головки, "0" -- верхняя, "1" -- нижняя.
 * бит 6: направление перемещения головок
 * бит 7: 40/80 дорожек
 * бит 8: признак "начало чтения"
 * бит 9: признак "запись маркера"
 * бит 10: схема предкоррекции

== 177132 ==
Регистр данных КНГМД. Доступен по чтению и записи.

== 177660 ==
Регистр состояния клавиатуры.
 * бит 6 -- маскирование прерывание от клавиатуры, "0" -- разрешено прерывание по вектору 060 либо 0274. Прерываение вызывается при появлении "1" в бите 7. Начальное состояние: "0".
 * бит 7 -- готовность: "1" -- в регистре данных клавиатуры (177662) готов код нажатой клавиши. Устанавливается при нажатии на клавишу, сбрасывается при чтении регистра данных клавиатуры. Начальное состояние: "0".
 * другие биты: "0".

См. также: порт 177716 бит 6 -- установлен в "0" если нажата клавиша клавиатуры, "1" если нет нажатых клавиш.

== 177662 ==
Регистр данных клавиатуры.
 * биты 0-6: код клавиши. Доступ только по чтению.
 * биты 8-11: (только БК-0011) палитра.
 * бит 14: разрешение прерывания по таймеру (50 Гц), "0" -- прерывание разрешено, "1" -- таймер отключен.
 * бит 15: (только БК-0011) текущий буфер экрана, "0" -- страница 5, "1" -- страница 6.

== 177664 ==
Регистр скроллинга.
 * биты 0-7: смещение скроллинга. Начальное значение -- 0330.
 * бит 9: сокращенный режим экрана, "0" -- сокращенный 1/4 экрана, "1" -- полный экран 256 строк.

== 177700 ==
Непонятно что.

== 177702 ==
Непонятно что.

== 177704 ==
Непонятно что.

== 177706 ==
Программируемый таймер -- регистр установки. Доступен по чтению и записи.

== 177710 ==
Программируемый таймер -- реверсивный счетчик. Доступен по чтению и записи.

== 177712 ==
Программируемый таймер -- регистр управления.
 * бит 0: "1" - остановка.
 * бит 1: начальная установка таймера.
 * бит 2: разрешение установки сигнала "конец счета".
 * бит 3: режим одновибратора
 * бит 4: запуск счетчика, "1" -- считает
 * бит 5: делитель на 16, "1" -- включен
 * бит 6: делитель на 4, "1" -- включен
 * бит 7: флаг окончания счета, "1" -- готовность
 * биты 8-15 не используются, "1".

== 177714 ==
Порт принтера, выводы на системном разъеме.

=== Принтер ===
TODO

=== Covox (запись) ===
TODO

=== Джойстик (чтение) ===
 * бит 0 -- кнопка 1
 * бит 1 -- кнопка 2
 * бит 2 -- кнопка 3
 * бит 3 -- кнопка 4
 * бит 4 -- вправо
 * бит 5 -- вниз
 * бит 9 -- влево
 * бит 10 -- вверх

== 177716 ==
Системный регистр.

По чтению:
 * бит 2: признак записи в системный регистр. Устанавливаеся в "1" при любой записи в регистр, сбрасывается в "0" по окончании операции чтения из регистра.
 * бит 5: данные с магнитофона
 * бит 6: нажатие клавиши, установлен в "0" если нажата клавиша клавиатуры, "1" если нет нажатых клавиш.
 * бит 7: TODO
 * биты 8-15: адрес начального пуска, 140000.
 * биты 0,1, 3,4 не используются, "0".

По записи, бит 11 = "0":
 * биты 2, 5, 6: данные на магнитофон.
 * бит 7: включение двигателя магнитофона.
 * бит 11: "0"
 * бит 12: разрешение прерывания по клавише СТОП

По записи, бит 11 = "1":
 * биты 0,1, 3,4,5,6: (БК-0011) страница ППЗУ
 * биты 8,9,10: (БК-0011) окно ОЗУ #1
 * бит 11: "1"
 * биты 12,13,14: (БК-0011) окно ОЗУ #0